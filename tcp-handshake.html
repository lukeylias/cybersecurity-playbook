<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cpath d='M16 2L4 7v9c0 8 5 14 12 16 7-2 12-8 12-16V7L16 2z' fill='%230a1628' stroke='%234a6fa5' stroke-width='2'/%3E%3Ccircle cx='16' cy='13' r='3.5' fill='none' stroke='%237ba3d4' stroke-width='2'/%3E%3Crect x='14.5' y='15' width='3' height='5' rx='1' fill='%237ba3d4'/%3E%3C/svg%3E">
    <title>TCP Handshake - Cybersecurity Fundamentals</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #0a1628;
            --bg-secondary: #0d1c30;
            --accent-primary: #4a6fa5;
            --accent-light: #7ba3d4;
            --accent-glow: rgba(74, 111, 165, 0.4);
            --text-primary: #e8f0f8;
            --text-secondary: #c4d4e8;
            --text-muted: #a8b8c8;
            --text-dim: #3a4a5a;
            --border-subtle: rgba(74, 111, 165, 0.2);
            --surface-subtle: rgba(74, 111, 165, 0.08);
            --surface-medium: rgba(74, 111, 165, 0.15);
            --surface-active: rgba(74, 111, 165, 0.25);
            --font-mono: 'DM Mono', monospace;
            --font-sans: 'DM Sans', system-ui, sans-serif;
        }

        body { font-family: var(--font-sans); background: var(--bg-primary); color: var(--text-secondary); min-height: 100vh; line-height: 1.6; }

        /* Navigation */
        .site-nav { position: fixed; top: 0; left: 0; right: 0; z-index: 100; background: rgba(10, 22, 40, 0.9); backdrop-filter: blur(12px); border-bottom: 1px solid var(--border-subtle); }
        .nav-container { max-width: 1200px; margin: 0 auto; padding: 0 24px; display: flex; align-items: center; justify-content: space-between; height: 60px; }
        .nav-logo { display: flex; align-items: center; gap: 12px; text-decoration: none; color: var(--text-primary); }
        .nav-logo-icon { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; }
        .nav-logo-text { font-weight: 500; font-size: 0.95rem; letter-spacing: 0.5px; }
        .nav-links { display: flex; align-items: center; gap: 6px; }
        .nav-dropdown { position: relative; }
        .nav-dropdown-btn { font-family: var(--font-mono); font-size: 0.75rem; color: var(--text-muted); background: none; border: 1px solid transparent; padding: 8px 14px; border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 6px; transition: all 0.2s; letter-spacing: 0.5px; }
        .nav-dropdown-btn:hover, .nav-dropdown.open .nav-dropdown-btn { color: var(--text-primary); background: var(--surface-subtle); border-color: var(--border-subtle); }
        .nav-dropdown-btn svg { width: 10px; height: 10px; transition: transform 0.2s; }
        .nav-dropdown.open .nav-dropdown-btn svg { transform: rotate(180deg); }
        .nav-dropdown-menu { position: absolute; top: calc(100% + 8px); left: 0; background: rgba(13, 28, 48, 0.98); border: 1px solid var(--border-subtle); border-radius: 10px; padding: 8px; min-width: 240px; opacity: 0; visibility: hidden; transform: translateY(-8px); transition: all 0.2s; box-shadow: 0 16px 48px rgba(0, 0, 0, 0.5); backdrop-filter: blur(12px); }
        .nav-dropdown.open .nav-dropdown-menu { opacity: 1; visibility: visible; transform: translateY(0); }
        .nav-dropdown-item { display: block; padding: 10px 14px; color: var(--text-secondary); text-decoration: none; border-radius: 6px; transition: all 0.15s; }
        .nav-dropdown-item:hover { background: var(--surface-medium); color: var(--text-primary); }
        .nav-dropdown-item.current .nav-dropdown-item-title { color: var(--accent-light); }
        .nav-dropdown-item-title { font-size: 0.85rem; font-weight: 500; margin-bottom: 2px; }
        .nav-dropdown-item-desc { font-family: var(--font-mono); font-size: 0.65rem; color: var(--text-muted); }
        .nav-mobile-toggle { display: none; background: none; border: 1px solid var(--border-subtle); color: var(--text-muted); padding: 6px 10px; border-radius: 4px; cursor: pointer; font-family: var(--font-mono); font-size: 0.8rem; }
        .nav-mobile-toggle:hover { color: var(--text-primary); background: var(--surface-subtle); }
        @media (max-width: 640px) {
            .nav-links { display: none; position: absolute; top: 60px; left: 0; right: 0; background: rgba(10, 22, 40, 0.98); border-bottom: 1px solid var(--border-subtle); padding: 12px; flex-direction: column; gap: 4px; backdrop-filter: blur(12px); }
            .nav-links.mobile-open { display: flex; }
            .nav-mobile-toggle { display: block; }
            .nav-dropdown { width: 100%; }
            .nav-dropdown-btn { width: 100%; }
            .nav-dropdown-menu { position: static; opacity: 1; visibility: visible; transform: none; box-shadow: none; border: none; background: var(--surface-subtle); border-radius: 8px; display: none; margin-top: 4px; min-width: auto; }
            .nav-dropdown.open .nav-dropdown-menu { display: block; }
        }

        .page { padding-top: 60px; min-height: 100vh; display: flex; flex-direction: column; }
        .page-content { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; }
        .page-header { text-align: center; margin-bottom: 40px; }
        .page-title { color: var(--text-primary); font-size: 1.3rem; font-weight: 500; letter-spacing: 1px; margin-bottom: 8px; }
        .page-subtitle { color: var(--accent-primary); font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 2px; text-transform: uppercase; }

        .main-content { display: flex; gap: 60px; align-items: flex-start; }

        .tcp-visualization { position: relative; width: 500px; height: 400px; }

        .tcp-device { position: absolute; padding: 20px 24px; background: var(--surface-subtle); border: 1px solid transparent; border-radius: 12px; transition: all 0.3s; cursor: pointer; min-width: 140px; text-align: center; }
        .tcp-device:hover { background: var(--surface-medium); }
        .tcp-device.active { background: var(--surface-active); border-color: var(--accent-primary); box-shadow: 0 0 40px var(--accent-glow); z-index: 10; }
        .tcp-device.connected { border-color: var(--accent-light); }
        .tcp-device-icon { font-size: 2rem; margin-bottom: 8px; }
        .tcp-device-label { font-family: var(--font-mono); font-size: 0.6rem; color: var(--accent-primary); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
        .tcp-device-title { font-weight: 500; font-size: 0.95rem; color: var(--text-primary); margin-bottom: 6px; }
        .tcp-device-info { font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-muted); }

        .device-client { top: 140px; left: 40px; }
        .device-server { top: 140px; right: 40px; }

        .tcp-connections { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .tcp-connections svg { width: 100%; height: 100%; }
        .connection-path { fill: none; stroke: var(--border-subtle); stroke-width: 2; stroke-dasharray: 4 4; }
        .connection-path.active { stroke: var(--accent-primary); stroke-dasharray: none; stroke-width: 3; }

        .tcp-packet { position: absolute; width: 80px; height: 50px; border-radius: 8px; background: var(--bg-primary); border: 2px solid var(--accent-primary); display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: var(--font-mono); font-size: 0.75rem; color: var(--accent-light); transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); z-index: 20; opacity: 0; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); }
        .tcp-packet.visible { opacity: 1; box-shadow: 0 0 20px var(--accent-glow); }
        .tcp-packet-label { font-weight: 500; margin-bottom: 2px; }
        .tcp-packet-details { font-size: 0.6rem; color: var(--text-muted); }

        .info-panel { width: 320px; min-height: 420px; }
        .info-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border-subtle); }
        .info-icon { font-size: 1.5rem; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--accent-primary); border-radius: 4px; }
        .info-title { font-size: 1.2rem; font-weight: 500; color: var(--text-primary); }
        .info-phase { font-family: var(--font-mono); font-size: 0.65rem; color: var(--accent-primary); text-transform: uppercase; letter-spacing: 1px; }
        .info-action { font-family: var(--font-mono); font-size: 0.8rem; color: var(--accent-light); margin-bottom: 16px; padding: 10px 14px; background: var(--surface-subtle); border-radius: 4px; border-left: 2px solid var(--accent-primary); }
        .info-description { font-size: 0.9rem; line-height: 1.7; color: var(--text-muted); margin-bottom: 20px; }
        .info-example { background: var(--surface-subtle); border-radius: 6px; padding: 14px; margin-bottom: 20px; }
        .info-example-label { font-family: var(--font-mono); font-size: 0.65rem; color: var(--accent-primary); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .info-example-content { font-family: var(--font-mono); font-size: 0.85rem; color: var(--text-primary); line-height: 1.6; }
        .info-example-content .dim { color: var(--text-muted); }
        .info-concepts { margin-top: 20px; }
        .info-concepts-title { font-family: var(--font-mono); font-size: 0.65rem; color: var(--accent-primary); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
        .concept-tag { display: inline-block; font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-secondary); padding: 6px 12px; background: var(--surface-medium); border-radius: 4px; margin: 0 6px 8px 0; }
        .info-intro { text-align: center; padding: 40px 20px; }
        .info-intro p { font-size: 0.9rem; line-height: 1.7; color: var(--text-muted); margin-bottom: 16px; }
        .info-intro .hint { font-family: var(--font-mono); font-size: 0.75rem; color: var(--accent-primary); }
        .info-intro .handshake-example { font-family: var(--font-mono); font-size: 0.9rem; color: var(--text-primary); background: var(--surface-subtle); padding: 12px 20px; border-radius: 6px; margin: 20px 0; display: inline-block; }

        .nav-controls { display: flex; gap: 12px; margin-top: 24px; align-items: center; justify-content: center; }
        button { font-family: var(--font-mono); background: transparent; color: var(--text-secondary); border: 1px solid var(--accent-primary); padding: 10px 24px; border-radius: 4px; cursor: pointer; font-size: 0.75rem; font-weight: 500; letter-spacing: 0.5px; transition: all 0.2s; }
        button:hover { background: var(--surface-medium); border-color: var(--accent-light); }
        button:disabled { color: var(--text-dim); border-color: #2a3a4a; cursor: not-allowed; }
        button:disabled:hover { background: transparent; }
        button.primary { background: var(--surface-medium); }
        .progress-dots { display: flex; gap: 4px; }
        .progress-dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(74, 111, 165, 0.3); transition: all 0.3s; }
        .progress-dot.active { background: var(--accent-primary); }
        .progress-dot.visited { background: rgba(74, 111, 165, 0.6); }

        @media (max-width: 1000px) {
            .main-content { flex-direction: column; align-items: center; }
            .tcp-visualization { transform: scale(0.85); transform-origin: top center; }
            .info-panel { width: 100%; max-width: 500px; }
        }
    </style>
</head>
<body>
    <nav class="site-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <div class="nav-logo-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="100%" height="100%"><path d="M16 2L4 7v9c0 8 5 14 12 16 7-2 12-8 12-16V7L16 2z" fill="#0a1628" stroke="#4a6fa5" stroke-width="2"/><circle cx="16" cy="13" r="3.5" fill="none" stroke="#7ba3d4" stroke-width="2"/><rect x="14.5" y="15" width="3" height="5" rx="1" fill="#7ba3d4"/></svg></div>
                <span class="nav-logo-text">Cybersecurity Fundamentals</span>
            </a>
            <button class="nav-mobile-toggle" onclick="document.querySelector('.nav-links').classList.toggle('mobile-open')">‚ò∞</button>
            <div class="nav-links">
                <div class="nav-dropdown">
                    <button class="nav-dropdown-btn" onclick="toggleDropdown(this)">Networking <svg viewBox="0 0 10 6" fill="none"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg></button>
                    <div class="nav-dropdown-menu">
                        <a href="network-fundamentals.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Network Fundamentals</div>
                            <div class="nav-dropdown-item-desc">IPs, ports, servers & clients</div>
                        </a>
                        <a href="protocols.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Protocol Reference</div>
                            <div class="nav-dropdown-item-desc">How services communicate</div>
                        </a>
                        <a href="ports.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Ports Reference</div>
                            <div class="nav-dropdown-item-desc">Common ports & red team quick ref</div>
                        </a>
                        <a href="osi-model.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">OSI Model</div>
                            <div class="nav-dropdown-item-desc">7-layer communication framework</div>
                        </a>
                        <a href="tcp-ip-model.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">TCP/IP Model</div>
                            <div class="nav-dropdown-item-desc">4-layer practical internet model</div>
                        </a>
                        <a href="arp.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">ARP Protocol</div>
                            <div class="nav-dropdown-item-desc">IP to MAC address resolution</div>
                        </a>
                        <a href="dns.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">DNS Lookup</div>
                            <div class="nav-dropdown-item-desc">Domain name resolution</div>
                        </a>
                        <a href="tcp-handshake.html" class="nav-dropdown-item current">
                            <div class="nav-dropdown-item-title">TCP Handshake</div>
                            <div class="nav-dropdown-item-desc">Three-way connection establishment</div>
                        </a>
                        <a href="vpn.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">VPN</div>
                            <div class="nav-dropdown-item-desc">Encrypted tunnels & privacy</div>
                        </a>
                        <a href="ssh.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">SSH</div>
                            <div class="nav-dropdown-item-desc">Secure remote access & key auth</div>
                        </a>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <button class="nav-dropdown-btn" onclick="toggleDropdown(this)">Web <svg viewBox="0 0 10 6" fill="none"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg></button>
                    <div class="nav-dropdown-menu">
                        <a href="http.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">HTTP Protocol</div>
                            <div class="nav-dropdown-item-desc">Methods, status codes, headers</div>
                        </a>
                        <a href="cookies.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Cookies</div>
                            <div class="nav-dropdown-item-desc">Maintaining state on the web</div>
                        </a>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <button class="nav-dropdown-btn" onclick="toggleDropdown(this)">Linux <svg viewBox="0 0 10 6" fill="none"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg></button>
                    <div class="nav-dropdown-menu">
                        <a href="linux.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Linux Command Line</div>
                            <div class="nav-dropdown-item-desc">Command line essentials</div>
                        </a>
                        <a href="linux-admin.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Packages & Logs</div>
                            <div class="nav-dropdown-item-desc">Software management & system logs</div>
                        </a>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <button class="nav-dropdown-btn" onclick="toggleDropdown(this)">Windows <svg viewBox="0 0 10 6" fill="none"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg></button>
                    <div class="nav-dropdown-menu">
                        <a href="windows-essentials.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Windows Essentials</div>
                            <div class="nav-dropdown-item-desc">MSConfig, utilities & admin tools</div>
                        </a>
                        <a href="windows-cmd.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Windows Command Line (CMD)</div>
                            <div class="nav-dropdown-item-desc">CMD commands & terminal reference</div>
                        </a>
                        <a href="windows-powershell.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Windows PowerShell</div>
                            <div class="nav-dropdown-item-desc">PowerShell cmdlets & scripting</div>
                        </a>
                        <a href="windows-security.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">Windows Security</div>
                            <div class="nav-dropdown-item-desc">Defender, firewall & device protection</div>
                        </a>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <button class="nav-dropdown-btn" onclick="toggleDropdown(this)">Practical <svg viewBox="0 0 10 6" fill="none"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg></button>
                    <div class="nav-dropdown-menu">
                        <a href="ctf-methodology.html" class="nav-dropdown-item">
                            <div class="nav-dropdown-item-title">CTF Methodology</div>
                            <div class="nav-dropdown-item-desc">Systematic approach to CTF challenges</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="page">
        <div class="page-content">
            <header class="page-header">
                <h1 class="page-title">TCP Handshake</h1>
                <p class="page-subtitle">Transmission Control Protocol</p>
                
                <div class="nav-controls">
                    <button id="prevBtn" onclick="prevStep()" disabled>‚Üê PREV</button>
                    <div class="progress-dots" id="progressDots"></div>
                    <button id="nextBtn" onclick="nextStep()" class="primary">NEXT ‚Üí</button>
                </div>
            </header>

            <div class="main-content">
                <div class="tcp-visualization">
                    <div class="tcp-connections">
                        <svg viewBox="0 0 500 400">
                            <path id="path-syn" class="connection-path" d="M 180 190 L 320 190" />
                            <path id="path-synack" class="connection-path" d="M 320 190 L 180 190" />
                            <path id="path-ack" class="connection-path" d="M 180 190 L 320 190" />
                        </svg>
                    </div>

                    <div class="tcp-packet" id="tcpPacket">
                        <div class="tcp-packet-label">SYN</div>
                        <div class="tcp-packet-details">seq: 1000</div>
                    </div>

                    <div class="tcp-device device-client" onclick="goToStep(0)">
                        <div class="tcp-device-icon">üíª</div>
                        <div class="tcp-device-label">Client</div>
                        <div class="tcp-device-title">Your Computer</div>
                        <div class="tcp-device-info">Port: 54321</div>
                    </div>

                    <div class="tcp-device device-server" onclick="goToStep(1)">
                        <div class="tcp-device-icon">üñ•Ô∏è</div>
                        <div class="tcp-device-label">Server</div>
                        <div class="tcp-device-title">Web Server</div>
                        <div class="tcp-device-info">Port: 443</div>
                    </div>
                </div>

                <div class="info-panel" id="infoPanel">
                    <div class="info-intro">
                        <p>Before two devices can exchange data over TCP, they must establish a reliable connection. This happens through a three-way handshake ‚Äî three packets exchanged to synchronize sequence numbers and confirm both sides are ready.</p>
                        <div class="handshake-example">SYN ‚Üí SYN-ACK ‚Üí ACK</div>
                        <p>This handshake ensures both devices agree on how to number the data packets and confirms the connection is working before any actual data is sent.</p>
                        <p class="hint">Click a device or press Next to begin ‚Üí</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const infoPanel = document.getElementById('infoPanel');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressDots = document.getElementById('progressDots');
        const tcpPacket = document.getElementById('tcpPacket');
        
        let currentStep = -1;
        const totalSteps = 5;

        for (let i = 0; i < totalSteps; i++) {
            const dot = document.createElement('div');
            dot.className = 'progress-dot';
            progressDots.appendChild(dot);
        }

        const steps = [
            {
                device: 'client', icon: 'üíª', title: 'Client Initiates', phase: 'Step 1: SYN',
                action: 'Client sends SYN packet',
                description: 'The client wants to establish a connection with the server. It sends a SYN (synchronize) packet containing an initial sequence number (ISN). This sequence number is randomly chosen and will be used to track all data sent from the client. The SYN flag in the TCP header indicates this is a connection request.',
                example: { label: 'SYN Packet', content: 'SYN=1, <span class="dim">seq=</span>1000, <span class="dim">ack=</span>0' },
                concepts: ['SYN flag', 'Sequence number', 'ISN', 'Connection request'],
                packetPos: { top: 175, left: 180 },
                packetContent: { label: 'SYN', details: 'seq: 1000' },
                direction: 'right'
            },
            {
                device: 'server', icon: 'üñ•Ô∏è', title: 'Server Responds', phase: 'Step 2: SYN-ACK',
                action: 'Server sends SYN-ACK packet',
                description: 'The server receives the SYN packet and responds with a SYN-ACK (synchronize-acknowledge) packet. This packet has two purposes: it acknowledges the client\'s SYN (by setting ACK=1001, which is the client\'s sequence number + 1), and it sends its own SYN with its own initial sequence number. The server is saying "I received your request, and I\'m ready to connect."',
                example: { label: 'SYN-ACK Packet', content: 'SYN=1, ACK=1, <span class="dim">seq=</span>5000, <span class="dim">ack=</span>1001' },
                concepts: ['SYN-ACK', 'Acknowledgment', 'ACK number', 'Server ISN'],
                packetPos: { top: 175, left: 320 },
                packetContent: { label: 'SYN-ACK', details: 'seq: 5000, ack: 1001' },
                direction: 'left'
            },
            {
                device: 'client', icon: 'üíª', title: 'Client Acknowledges', phase: 'Step 3: ACK',
                action: 'Client sends ACK packet',
                description: 'The client receives the SYN-ACK and sends a final ACK (acknowledge) packet. This packet acknowledges the server\'s SYN by setting ACK=5001 (server\'s sequence number + 1). At this point, both devices have confirmed they received each other\'s connection requests. The connection is now established and ready for data transfer.',
                example: { label: 'ACK Packet', content: 'ACK=1, <span class="dim">seq=</span>1001, <span class="dim">ack=</span>5001' },
                concepts: ['ACK', 'Connection established', 'Data ready', 'Bidirectional'],
                packetPos: { top: 175, left: 180 },
                packetContent: { label: 'ACK', details: 'seq: 1001, ack: 5001' },
                direction: 'right'
            },
            {
                device: 'both', icon: '‚úÖ', title: 'Connection Established', phase: 'Ready for data',
                action: 'Both sides are synchronized',
                description: 'The three-way handshake is complete! Both the client and server have agreed on their sequence numbers and confirmed the connection is working. The client knows the server is ready (sequence numbers 1000-1001 for client, 5000-5001 for server), and the server knows the client is ready. They can now exchange data packets reliably, with each side tracking what it has sent and received.',
                example: { label: 'Connection State', content: 'ESTABLISHED<br><span class="dim">Client seq: 1001, Server seq: 5001</span>' },
                concepts: ['ESTABLISHED', 'Data transfer', 'Reliable delivery', 'Full-duplex'],
                packetPos: { top: 175, left: 250 },
                packetContent: { label: '‚úì', details: 'Connected' },
                direction: 'none'
            }
        ];

        function updateUI() {
            document.querySelectorAll('.progress-dot').forEach((dot, i) => {
                dot.classList.remove('active', 'visited');
                if (i === currentStep) dot.classList.add('active');
                else if (i < currentStep) dot.classList.add('visited');
            });

            prevBtn.disabled = currentStep <= 0;
            nextBtn.textContent = currentStep >= totalSteps - 1 ? 'RESTART' : 'NEXT ‚Üí';

            document.querySelectorAll('.tcp-device').forEach(d => d.classList.remove('active', 'connected'));
            document.querySelectorAll('.connection-path').forEach(p => p.classList.remove('active'));

            if (currentStep >= 0) {
                const step = steps[currentStep];
                
                if (step.device === 'client') {
                    document.querySelector('.device-client').classList.add('active');
                } else if (step.device === 'server') {
                    document.querySelector('.device-server').classList.add('active');
                } else if (step.device === 'both') {
                    document.querySelector('.device-client').classList.add('connected');
                    document.querySelector('.device-server').classList.add('connected');
                }

                tcpPacket.classList.add('visible');
                tcpPacket.style.top = step.packetPos.top + 'px';
                tcpPacket.style.left = step.packetPos.left + 'px';
                tcpPacket.querySelector('.tcp-packet-label').textContent = step.packetContent.label;
                tcpPacket.querySelector('.tcp-packet-details').textContent = step.packetContent.details;

                const paths = {
                    0: ['path-syn'],
                    1: ['path-syn', 'path-synack'],
                    2: ['path-syn', 'path-synack', 'path-ack'],
                    3: ['path-syn', 'path-synack', 'path-ack']
                };
                (paths[currentStep] || []).forEach(id => document.getElementById(id)?.classList.add('active'));

                infoPanel.innerHTML = `
                    <div class="info-header">
                        <div class="info-icon">${step.icon}</div>
                        <div>
                            <div class="info-title">${step.title}</div>
                            <div class="info-phase">${step.phase}</div>
                        </div>
                    </div>
                    <div class="info-action">${step.action}</div>
                    <p class="info-description">${step.description}</p>
                    <div class="info-example">
                        <div class="info-example-label">${step.example.label}</div>
                        <div class="info-example-content">${step.example.content}</div>
                    </div>
                    <div class="info-concepts">
                        <div class="info-concepts-title">Key Concepts</div>
                        ${step.concepts.map(c => `<span class="concept-tag">${c}</span>`).join('')}
                    </div>
                `;
            } else {
                tcpPacket.classList.remove('visible');
                infoPanel.innerHTML = `
                    <div class="info-intro">
                        <p>Before two devices can exchange data over TCP, they must establish a reliable connection. This happens through a three-way handshake ‚Äî three packets exchanged to synchronize sequence numbers and confirm both sides are ready.</p>
                        <div class="handshake-example">SYN ‚Üí SYN-ACK ‚Üí ACK</div>
                        <p>This handshake ensures both devices agree on how to number the data packets and confirms the connection is working before any actual data is sent.</p>
                        <p class="hint">Click a device or press Next to begin ‚Üí</p>
                    </div>
                `;
            }
        }

        function goToStep(step) { 
            currentStep = Math.max(-1, Math.min(totalSteps - 1, step)); 
            updateUI(); 
        }
        
        function nextStep() { 
            currentStep = currentStep >= totalSteps - 1 ? -1 : currentStep + 1; 
            updateUI(); 
        }
        
        function prevStep() { 
            if (currentStep > 0) { 
                currentStep--; 
                updateUI(); 
            } 
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextStep();
            else if (e.key === 'ArrowLeft') prevStep();
        });

        updateUI();
    </script>
    <script>
        function toggleDropdown(btn) {
            const dropdown = btn.parentElement;
            const wasOpen = dropdown.classList.contains('open');
            document.querySelectorAll('.nav-dropdown').forEach(d => d.classList.remove('open'));
            if (!wasOpen) dropdown.classList.add('open');
        }
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.nav-dropdown')) {
                document.querySelectorAll('.nav-dropdown').forEach(d => d.classList.remove('open'));
            }
        });
    </script>
</body>
</html>

